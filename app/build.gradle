apply plugin: 'com.android.application'
apply plugin: 'com.google.android.gms.oss-licenses-plugin'

buildscript {
    repositories {
        google()
        jcenter()
        maven { url 'https://maven.fabric.io/public' }
    }
    dependencies {
        classpath 'io.fabric.tools:gradle:1.+'
        classpath 'com.google.android.gms:oss-licenses-plugin:0.9.4'
    }
}

apply plugin: 'kotlin-android'
apply plugin: 'kotlin-android-extensions'
apply plugin: 'kotlin-kapt'
apply plugin: 'io.fabric'
apply from: '../keys.gradle'

android {
    compileSdkVersion rootProject.ext.compileSdkVersion
    defaultConfig {
        applicationId "io.github.koss.mammut"
        minSdkVersion rootProject.ext.minSdkVersion
        targetSdkVersion rootProject.ext.targetSdkVersion
        versionCode rootProject.ext.versionCode
        versionName rootProject.ext.versionName

        testInstrumentationRunner "androidx.test.runner.AndroidJUnitRunner"

        buildConfigField "String", "INSTANCES_SECRET", INSTANCES_SECRET
    }

    buildTypes {
        release {
            minifyEnabled false
            proguardFiles getDefaultProguardFile('proguard-android.txt'), 'proguard-rules.pro'
        }

        debug {
            minifyEnabled false
            applicationIdSuffix ".debug"
            versionNameSuffix '-debug'
        }
    }

    sourceSets {
        release.java.srcDirs += 'build/generated/source/kaptKotlin/release'
        debug.java.srcDirs += 'build/generated/source/kaptKotlin/debug'
    }

    compileOptions {
        sourceCompatibility 1.8
        targetCompatibility 1.8
    }
}

repositories {
    google()
    jcenter()
    maven { url 'https://jitpack.io' }
    maven { url 'https://maven.fabric.io/public' }
}

dependencies {
    implementation fileTree(dir: 'libs', include: ['*.jar'])
    implementation rootProject.ext.kotlinRuntime
    implementation rootProject.ext.coroutinesCore
    implementation rootProject.ext.coroutinesAndroid

    implementation rootProject.ext.appCompat
    implementation rootProject.ext.constraintLayout

    implementation rootProject.ext.dagger
    kapt rootProject.ext.daggerCompiler

    implementation rootProject.ext.randux

    implementation rootProject.ext.lifecycle
    implementation rootProject.ext.lifecycleRx

    implementation rootProject.ext.anko

    implementation rootProject.ext.material

    implementation rootProject.ext.rxJava
    implementation rootProject.ext.rxAndroid
    implementation rootProject.ext.rxKotlin

    implementation rootProject.ext.arrowCore
    implementation rootProject.ext.arrowSyntax
    implementation rootProject.ext.arrowTypeclasses
    implementation rootProject.ext.arrowData
    implementation rootProject.ext.arrowInstancesCore
    implementation rootProject.ext.arrowInstancesCoreData
    implementation rootProject.ext.arrowOptics
    kapt rootProject.ext.arrowProcessor

    implementation rootProject.ext.calligraphy

    implementation rootProject.ext.mastodon4j

    implementation rootProject.ext.room
    kapt rootProject.ext.roomCompiler

    implementation rootProject.ext.retrofit
    implementation rootProject.ext.retrofitGsonConverter

    implementation rootProject.ext.glide
    implementation rootProject.ext.glideTransformations
    kapt rootProject.ext.glideCompiler

    implementation rootProject.ext.inboxRecyclerView

    implementation rootProject.ext.paging

    implementation rootProject.ext.threetenabp

    implementation rootProject.ext.conductor
    implementation rootProject.ext.conductorArchLifecycle
    implementation rootProject.ext.conductorSupport

    implementation(rootProject.ext.crashlytics) {
        transitive = true
    }

    implementation rootProject.ext.ktx

    implementation rootProject.ext.gestureView

    implementation rootProject.ext.exoCore
    implementation rootProject.ext.exoUi

    implementation rootProject.ext.flexAdapter

    implementation rootProject.ext.ossLicenses

    implementation rootProject.ext.lottie

    implementation rootProject.ext.customTabsHelper
}

androidExtensions {
    experimental = true
}
